<div class="col-sm-12" >
	<form action="" id="dateQueryForm" method="post">
		<div class="form-group">
			<div class="col-sm-4">
				<div class="btn-group" id="dayChange">
					<button type="button" id="weekButton" class="btn btn-default">周</button>
					<button type="button" id="monthButton" class="btn btn-default">月</button>
					<button type="button" id="quarterButton" class="btn btn-default">季</button>
					<button type="button" id="yearButton" class="btn btn-default">年</button>
				</div>
			</div>
			<div class="col-sm-3" id="start_dt_div">
				<div class="input-group m-b date" data-date="yyyy-mm-dd">
					<input class="input-sm form-control" id="start_dt" value="${start_dt!}" name="start_dt"
						type="text" data-date-format="yyyy-mm-dd">
					<i class="add-on input-group-addon icon-calendar"></i>
				</div>
			</div>
			<label class="col-sm-1 control-label" style="margin-top: 8px; margin-right: -50px; margin-left: -20px">至 </label>
			<div class="col-sm-3" id="end_dt_div">
				<div class="input-group m-b date" data-date="yyyy-mm-dd">
					<input class="input-sm form-control" id="end_dt" value="${end_dt!}" name="end_dt" type="text"
						data-date-format="yyyy-mm-dd"
					>
					<i class="add-on input-group-addon icon-calendar"></i>
				</div>
			</div>
			<div class="col-sm-1">
				<button type="button" class="btn btn-sm btn-primary" id="dateQuery" onclick="commonQuery()">查询</button>
			</div>
		</div>
	</form>
</div>
<div class="clear">
	<hr />
</div>

<script>
    /**
	 * 设置日期插件的格式
     */
    $(document).ready(function () {
        $('#start_dt_div .input-group.m-b.date').datepicker({
			format:'yyyy-mm-dd',
            autoclose: true,
            todayHighlight: true
        });
        $('#end_dt_div .input-group.m-b.date').datepicker({
			format:'yyyy-mm-dd',
            autoclose: true,
            todayHighlight: true
        });
    });

</script>

<script>
	$(document).ready(function() {
	    //设置按钮的样式
		$("#dayChange .btn").click(function() {
			$("#dayChange .btn").removeClass("active");
			$(this).addClass("active");
		});

		//设置日期查询的默认值
		if ($("#start_dt").val() == "") {
			$("#start_dt").val(getDateStr(-1));
		}
		if ($("#end_dt").val() == "") {
            $("#end_dt").val(getDateStr(0));
		}
		//导出按钮导出数据
		csvExport();
		//根据时间查找数据
		query();
	});

	//设置tab csv导出action
	//设置csv导出action
	function csvExport() {
		var start = $("#start_dt").val();
		var end = $("#end_dt").val();
		//tab excel导出
		$("header .nav-tabs .csvExportTab").click(
				function() {
					var action = $(this).attr("csvAction");
					action = "/csv/" + action;
					$("#csvExport").attr("href",
							action + "?start_dt=" + start + "&end_dt=" + end);
				});
		var action = "/csv/"
				+ $("header .nav-tabs .active.csvExportTab").attr("csvAction");
		$("#csvExport").attr("href",
				action + "?start_dt=" + start + "&end_dt=" + end);
		//excel导出
		$(".csvExport").each(
				function() {
					var action = $(this).attr("csvAction");
					$(this).attr("href",
							action + "?start_dt=" + start + "&end_dt=" + end);
				});
	}
</script>

<script>

    function query() {
        var start = $("#start_dt").val();
        var end = $("#end_dt").val();
        var ajaxOption = {
            url : window.location.href + "?start_dt=" + start + "&end_dt="
            + end,
            success : function(data) {
                dataTableExchange(data);
            }
        };
        commonAjax(ajaxOption);
    }

    $("#monthButton").click(function () {
        var ajaxOption = {
            url : window.location.href + "?type=month",
            success : function(data) {
                dataTableExchange(data);
            }
        };
        commonAjax(ajaxOption);
    });
    $("#quarterButton").click(function () {
        var ajaxOption = {
            url : window.location.href + "?type=quarter",
            success : function(data) {
                dataTableExchange(data);
            }
        };
        commonAjax(ajaxOption);
    });
    $("#yearButton").click(function () {
        var ajaxOption = {
            url : window.location.href + "?type=year",
            success : function(data) {
                dataTableExchange(data);
            }
        };
        commonAjax(ajaxOption);
    });
</script>