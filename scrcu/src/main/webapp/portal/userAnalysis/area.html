<#include "/common/_layout.html"/> <@layout>
<div class="top">
	<ul class="breadcrumb">
		<li><a href="admin"><i class="fa fa-home"></i> 首页</a></li>
		<li>用户分析</li>
		<li>地域分布</li>
	</ul>
</div>
<section id="content">
	<div style="margin: -20px -30px 30px -30px; background: #E0EAEC; padding-top: 20px">
		<div id="provincediv" style="height: 400px; margin: 0px 30px 0px 30px;"></div>
	</div>
	<#include "/common/_dateQuery.html"/>
	<div>
		<div class="btn-group " style="padding-left: 8px;">
			<button type="button" class="noshadow btn btn-info"
				style="padding: 10px 10px; background: #f2f2f2; color: #444 !important; border-color: #dbe2e7; font-size: 12px; border-bottom: 0px"
			>
				<i class="fa-list fa padder-xs"></i>地域分布
			</button>
			<#include "/common/_custom_column.html"/>
		</div>
		<span class="hidden-sm pull-right"> <a href="" csvAction="/csv/portal_siteAnalysis_area_query"
			class="csvExport btn btn-default btn-sm" style="display: inline;"
		><i class="fa fa-cloud-download"></i>&nbsp;导出</a>
		</span>
	</div>
	<section class="panel panel-default ">
		<div class="table-responsive">
			<table id="table" class="table_select_row datatables table table-striped m-b-none" style="border-top: 0px"
				data-ride="datatables"
			>
				<thead>
					<tr>
						<th class="w-2">城市</th>
						<th class="w-2">访客</th>
						<th class="w-3">UV占比</th>
						<th class="w-2">PV</th>
						<th class="w-2">VV</th>
						<th class="w-2">IP数</th>
						<th class="w-3">新访客</th>
						<th class="w-4">新访客占比</th>
						<th class="w-4">平均深度</th>
						<th class="w-2" show="false">登录</th>
						<th class="w-5" show="false">登录/访客数</th>
						<th class="w-3" show="false">注册数</th>
						<th class="w-5" show="false">注册/访客数</th>
					</tr>
				</thead>
				<tbody>
				</tbody>
			</table>
		</div>
	</section>
	<div class="clear"></div>

</section>
</@layout>
<script>
	function query(flag) {
		if (flag) {
			$("#yesterdayButton").click();
			return;
		}
		var start = $("#start_dt").val();
		var end = $("#end_dt").val();
		var ajaxOption = {
			url : window.location.href + "?start_dt=" + start + "&end_dt="
					+ end,
			success : function(data) {
				var chart = echarts.init(
						document.getElementById('provincediv'), 'macarons');
				var chartOption = data.chartOption;
				var option = {
					"aaData" : data.data,
					"sDom" : "",
					bPaginate : false,
					bInfo : false,
					bFilter : false,
					bLengthChange : false,
					"aoColumnDefs": [
						{"targets": [3], // 目标列位置，下标从0开始
	                    "render": function(data) { // 返回自定义内容
	                  	  return getPercent(data);
	                    }},
	                    {"targets": [8], // 目标列位置，下标从0开始
	                    	"render": function(data) { // 返回自定义内容
	                  	    return getPercent(data);
	                    }},
	                    {"targets": [11], // 目标列位置，下标从0开始
	                    	"render": function(data) { // 返回自定义内容
	                  	    return getPercent(data);
	                    }},
	                    {"targets": [13], // 目标列位置，下标从0开始
	                    	"render": function(data) { // 返回自定义内容
	                  	    return getPercent(data);
	                    }}
					]
				};
				tableQuery(option);
				chart.setOption($.parseJSON(chartOption));
			}
		};
		commonAjax(ajaxOption);
	}

</script>
